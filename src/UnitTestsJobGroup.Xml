<?xml version="1.0" encoding="utf-8"?>
<!-- Test Job Group to run the Attestation Service Pre-checkin validation tests -->
<TestJobGroup>
  <ResourceSpec>
    <Resource type="VirtualMachine" SKU="Standard_DS4_V2" Image="Native_Win2016_v2" />
  </ResourceSpec>
  <Setup>
    <BuildFiles>
       <!-- The fakes assemblies used by the UnitTests.dll test library don't work if the test binaries are symlinked
       to their deployment location, so we force the UnitTests files to be copied to their target location instead of
       just being symlinked. -->
        <Copy Src="[BuildRoot]\outputs\build\BuildOutputs\*" Dest="[WorkingDirectory]\" IsRecursive="true" Writable="true"/>
    </BuildFiles>
  </Setup>

  <TestJob Name="AzureDCAP.UnitTests">
    <Execution Type="MsTest" Path="[WorkingDirectory]\gUnitTests.exe" Args="/TestAdapterPath:C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\Common7\IDE\Extensions\ubawx25q.gzi /Platform:x64"/>
  </TestJob>
  <TestJob Name="AzureDCAP.DCAPTests">
    <Execution Type="MsTest" Path="[WorkingDirectory]\dcap_provider_tests.dll" Args="/Platform:x64"/>
  </TestJob>
</TestJobGroup>
